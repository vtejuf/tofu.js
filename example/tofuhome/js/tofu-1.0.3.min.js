/*!
 * tofojs v1.0.3 (http://tofujs.goodgame.com)
 * Copyright 2015-2016 tofojs.goodgame.asia
 * Author vtejuf@163.com
 * BSD License
 */
function Tofu(a){function e(a,b){this.name=a,this.controller=d.module_base+"/"+a+"/js/controller.js",this.container=b,this.template}function f(a){var b,c;return d.loadScript?(b=d.loadScript.bind(a),b(),void 0):(c=document.createElement("script"),c.type="text/javascript",c.src=a.controller,c.onload=function(){document.head.removeChild(c),a.onready()},document.head.appendChild(c),void 0)}function g(a){function g(){4==e.readyState&&(0==e.status||200==e.status||304==e.status)&&(a.template=e.responseText.replace(/{{Tofu.(.+?)}}/gm,function(a,c){return b[c]||c}),f(a))}var b={module_url:d.module_base+"/"+a.name},c=d.module_base+"/"+a.name+"/index.html",e=new XMLHttpRequest;e.onreadystatechange=g,e.open("GET",c,d.async),e.send(null)}function h(){var a,d,f,h,i;if(!b||!c.event[b])for(d="string"==typeof b?document.querySelectorAll('[data-tofu-module="'+b+'"]'):document.querySelectorAll("[data-tofu-module]"),f=0,h=d.length;h>f;f++)i=d[f].getAttribute("data-tofu-module"),""!=i&&(a=new e(i,d[f]),c.event[i]||(c.event[i]={},c.event[i].$tofu=a,g(a)))}var b=a,c=arguments.callee,d=c.config;d.async=d.async===!1?d.async:!0,d.module_base=d.module_base||"/modules",e.prototype.remove=function(a){a&&this.container.parentNode.removeChild(this.container),delete c.event[this.name]},e.prototype.addEventListener=function(a,b){return b?(c.event[this.name][a]=b.bind(this),void 0):!1},e.prototype.dispatchEvent=function(a,b,d){arguments.length<3&&(d=b,b=a,a=this.name),c.event[a][b]&&c.event[a][b](d)},e.prototype.removeEventListener=function(a){!!c.event[this.name][a]&&delete c.event[this.name][a]},e.prototype.onready=function(a){var b=this,d=setTimeout(function(){c.event[b.name].isReady?(clearTimeout(d),b.dispatchEvent(b.name,"ready",a)):d=setTimeout(arguments.callee,0)},0)},h()}+function(){Tofu.event={}}(),Tofu.ready=function(a,b,c){var d,e;if("function"==typeof b&&(c=b,b=[]),count=l=b.length,0==l)Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(Tofu.event[a].$tofu)||function(){},delete Tofu.event[a].$tofu;else for(d=0;l>d;d++)e=document.createElement("script"),e.type="text/javascript",e.src=b[d],e.onload=function(){document.head.removeChild(e),0==--count&&(Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(Tofu.event[a].$tofu)||function(){},delete Tofu.event[a].$tofu)},document.head.appendChild(e)},Tofu.isReady=function(a){return!!Tofu.event[a]&&Tofu.event[a].isReady},Tofu.config=function(a){Tofu.config=a},window.$tf=Tofu;