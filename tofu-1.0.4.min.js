/*!
 * tofojs v1.0.4 (http://tofujs.goodgame.com)
 * Copyright 2015-2016 tofojs.goodgame.asia
 * Author vtejuf@163.com
 * BSD License
 */
function Tofu(a,b){function h(a,b){this.name=a,this.controller=f.module_base+"/"+a+"/js/controller.js",this.container=b,this.template,+function(){}(this)}function i(){for(var d,e,a=arguments.length,b=0,c=arguments[0];++b<a;)if(d=arguments[b],"object"==typeof d)for(e in d)c[e]=d[e];return c}function j(a){if(f.loadScript)return f.loadScript(a.name,a.container,a.template),void 0;var b=document.createElement("script");b.type="text/javascript",b.src=a.controller+g,b.onload=function(){document.head.removeChild(b)},document.head.appendChild(b)}function k(a){function e(){4==d.readyState&&(0==d.status||200==d.status||304==d.status)&&(a.template=d.responseText.replace(/{{Tofu.(.+?)}}/gm,function(a,c){return b[c]||c}),j(a))}var b={module_url:f.module_base+"/"+a.name},c=f.module_base+"/"+a.name+"/index.html"+g,d=new XMLHttpRequest;d.onreadystatechange=e,d.open("GET",c,f.async),d.setRequestHeader("Content-Type","text/html"),d.setRequestHeader("charset","utf-8"),d.send(null)}function l(){var a,b,c,f,g;if(!d||!e.event[d])for(b="string"==typeof d?document.querySelectorAll('[data-tofu-module="'+d+'"]'):document.querySelectorAll("[data-tofu-module]"),c=0,f=b.length;f>c;c++)g=b[c].getAttribute("data-tofu-module"),""!=g&&(a=new h(g,b[c]),e.event[g]||(e.event[g]={},e.event[g].$tofu=a,k(a)))}var c={async:!0,staticStamp:!1,module_base:"/modules"},d=a,e=arguments.callee,f=i({},c,e.config,b),g=f.staticStamp?"?"+f.staticStamp.toLowerCase()+"="+(new Date).getTime():"";h.prototype.remove=function(a){a&&this.container.parentNode.removeChild(this.container),delete e.event[this.name]},h.prototype.addEventListener=function(a,b){return b?(e.event[this.name][a]=b.bind(this),void 0):!1},h.prototype.dispatchEvent=function(a,b,c){e.event[a][b]&&e.event[a][b](c)},h.prototype.removeEventListener=function(a){!!e.event[this.name][a]&&delete e.event[this.name][a]},l()}+function(){Tofu.event={}}(),Tofu.ready=function(a,b,c){var d,e,f;if("function"==typeof b&&(c=b,b=[]),l=b.length,0==l)Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(Tofu.event[a].$tofu)||function(){},delete Tofu.event[a].$tofu,Tofu.event[a].ready();else{for(d=l,e=document.createElement("a"),f=0;l>f;f++)+function(f){var g,h;e.href=b[f],g=e.pathname.split(".").pop(),"js"==g?(h=document.createElement("script"),h.type="text/javascript",h.src=b[f]):"css"==g&&(h=document.createElement("link"),h.type="text/css",h.rel="stylesheet",h.href=b[f]),h.onload=function(){"css"!=g&&document.head.removeChild(h),0==--d&&(Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(Tofu.event[a].$tofu)||function(){},delete Tofu.event[a].$tofu,Tofu.event[a].ready())},document.head.appendChild(h)}(f);delete e}},Tofu.isReady=function(a){return!!Tofu.event[a]&&Tofu.event[a].isReady},Tofu.config=function(a){Tofu.config=a},window.$tf=Tofu;