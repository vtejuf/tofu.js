/*!
 * tofojs v1.1.3 (http://tofujs.goodgame.com)
 * Copyright 2015-2016 tofojs.goodgame.asia
 * Author vtejuf@163.com
 * BSD License
 */
function Tofu(a,b){function h(a,b){this.name=a,this.controller=f.module_base+"/"+a+"/js/controller.js",this.container=b,this.template,+function(){}(this)}function i(){for(var d,e,a=arguments.length,b=0,c=arguments[0];++b<a;)if(d=arguments[b],"object"==typeof d)for(e in d)c[e]=d[e];return c}function j(a){if(f.loadScript)return f.loadScript(a.name,a.container,a.template),void 0;var b=document.createElement("script");b.type="text/javascript",b.src=a.controller+g,b.onload=function(){document.head.removeChild(b)},document.head.appendChild(b)}function k(a){function e(){4==d.readyState&&(0==d.status||200==d.status||304==d.status)&&(a.template=d.responseText.replace(/{{Tofu.(.+?)}}/gm,function(a,c){return b[c]||c}),j(a))}var b={module_url:f.module_base+"/"+a.name},c=f.module_base+"/"+a.name+"/index.html"+g,d=new XMLHttpRequest;d.onreadystatechange=e,d.open("GET",c,f.async),d.setRequestHeader("Content-Type","text/html"),d.setRequestHeader("charset","utf-8"),d.send(null)}function l(){var a,b,c,f,g;if(!d||!e.event[d])for(b="string"==typeof d?document.querySelectorAll('[data-tofu-module="'+d+'"]'):document.querySelectorAll("[data-tofu-module]"),c=0,f=b.length;f>c;c++)g=b[c].getAttribute("data-tofu-module"),""!=g&&(a=new h(g,b[c]),e.event[g]||(e.event[g]={},e.event[g].$tofu=a,k(a)))}var c={async:!0,staticStamp:!1,module_base:"/modules"},d=a,e=arguments.callee,f=i({},c,e.config,b),g=f.staticStamp?"?"+f.staticStamp.toLowerCase()+"="+(new Date).getTime():"";h.prototype.remove=function(a){a&&this.container.parentNode.removeChild(this.container),delete e.event[this.name]},h.prototype.addEventListener=function(a,b){return b?(e.event[this.name][a]=b.bind(this),void 0):!1},h.prototype.dispatchEvent=function(a,b,c){e.event[a][b]&&e.event[a][b](c)},h.prototype.removeEventListener=function(a){!!e.event[this.name][a]&&delete e.event[this.name][a]},h.prototype.on=function(){"function"==typeof arguments[1]?this.addEventListener.apply(this,arguments):this.dispatchEvent.apply(this,arguments)},h.prototype.off=function(){this.removeEventListener.apply(this,arguments)},h.prototype.render=function(a,b){var f,g,h,i,j,k,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},d=function(a){var b=function(b){return a[b]},c="(?:"+Object.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};return d(c),f={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},g=/(.)^/,h={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},i=/\\|'|\r|\n|\u2028|\u2029/g,j=function(a){return"\\"+h[a]},k=function(a){var e,k,l,b=RegExp([(f.escape||g).source,(f.interpolate||g).source,(f.evaluate||g).source].join("|")+"|$","g"),c=0,d="__p+='";a.replace(b,function(b,e,f,g,h){return d+=a.slice(c,h).replace(i,j),c=h+b.length,e?d+="'+\n((__t=(typeof "+e+"!='undefined'?"+e+":null))==null?'':escape(__t))+\n'":f?d+="'+\n((__t=(typeof "+f+"!='undefined'?"+f+":null))==null?'':__t)+\n'":g&&(d+="';\n"+g+"\n__p+='"),b}),d+="';\n",f.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+d+"return __p;\n";try{e=new Function(f.variable||"obj",d)}catch(h){throw h.source=d,h}return k=function(a){return e.call(this,a)},l=f.variable||"obj",k.source="function("+l+"){\n"+d+"}",k},"string"==typeof a||"undefined"==typeof a?(b=a,a=void 0,k(b||this.template)):k(b||this.template)(a)},l()}+function(){Tofu.event={}}(),Tofu.ready=function(a,b,c){var d,e,f,g;if("function"==typeof b&&(c=b,b=[]),d=Tofu.event[a].$tofu,delete Tofu.event[a].$tofu,l=b.length,0==l)Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(d)||function(){},Tofu.event[a].ready(),Tofu.event[a].onready&&Tofu.event[a].onready(d.name,d.container,d.template);else{for(e=l,f=document.createElement("a"),g=0;l>g;g++)+function(g){var h,i;/\.(js|css)$/i.test(b[g])||(b[g]+=".js"),f.href=b[g],h=f.pathname.split(".").pop(),"js"==h?(i=document.createElement("script"),i.type="text/javascript",i.src=b[g]):"css"==h&&(i=document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=b[g]),i.onload=function(){"css"!=h&&document.head.removeChild(i),0==--e&&(Tofu.event[a].isReady=!0,Tofu.event[a].ready=c.bind(d)||function(){},Tofu.event[a].ready(),Tofu.event[a].onready&&Tofu.event[a].onready(d.name,d.container,d.template))},i.onerror=function(){document.head.removeChild(i)},document.head.appendChild(i)}(g);delete f}},Tofu.isReady=function(a){return!!this.event[a]&&this.event[a].isReady},Tofu.config=function(a){this.config=a},Tofu.removeModule=function(a,b){var c=document.querySelector('[data-tofu-module="'+a+'"]');b&&c&&c.parentNode.removeChild(c),c&&delete this.event[a]},Tofu.on=function(a,b,c){this.event[a][b]&&this.event[a][b](c)},Tofu.onReady=function(a,b){this.event[a].onready=b.bind(null)},window.$tf=Tofu;